"use strict";(self["webpackChunkproject"]=self["webpackChunkproject"]||[]).push([[471],{8266:function(t,e,s){s.d(e,{Z:function(){return l}});var a=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"modal fade",attrs:{id:"delModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"}},[e("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[e("div",{staticClass:"modal-content border-0"},[t._m(0),e("div",{staticClass:"modal-body"},[t._v(" 是否刪除 "),e("strong",{staticClass:"text-danger"},[t._v(t._s(t.item.title))]),t._v(" 商品(刪除後將無法恢復)。 ")]),e("div",{staticClass:"modal-footer"},[e("button",{staticClass:"btn btn-outline-secondary",attrs:{type:"button","data-bs-dismiss":"modal"}},[t._v(" 取消 ")]),e("button",{staticClass:"btn btn-danger",attrs:{type:"button"},on:{click:t.delProduct}},[t.status.update?e("i",{staticClass:"fas fa-spinner fa-spin me-1"}):t._e(),t._v("確認刪除")])])])])])])},o=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"modal-header bg-danger text-white"},[e("h5",{staticClass:"modal-title",attrs:{id:"exampleModalLabel"}},[e("span",[t._v("刪除產品")])]),e("button",{staticClass:"btn-close",attrs:{type:"button","data-bs-dismiss":"modal","aria-label":"Close"}})])}],d={props:["item","status"],methods:{delProduct(){this.$emit("delete")}}},i=d,n=s(1001),u=(0,n.Z)(i,a,o,!1,null,null,null),l=u.exports},7471:function(t,e,s){s.r(e),s.d(e,{default:function(){return h}});var a=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"text-center"},[e("loading",{attrs:{active:t.isLoading},on:{"update:active":function(e){t.isLoading=e}}})],1),e("div",{staticClass:"text-end mt-4"},[e("button",{staticClass:"btn btn-primary",on:{click:t.openModal}},[t._v(" 建立新的產品 ")])]),e("Table",{attrs:{item:t.tempProduct,products:t.products},on:{edit:t.openModal,delete:t.delModal}}),e("div",{staticClass:"d-flex justify-content-center"},[e("Pagination",{attrs:{pagination:t.pagination},on:{pageItem:t.getProducts}})],1),e("Modal",{attrs:{item:t.tempProduct,"is-new":t.isNew,status:t.status},on:{update:t.updateProduct}}),e("DeleteModal",{attrs:{item:t.tempProduct,status:t.status},on:{delete:t.delProduct}})],1)},o=[],d=s(2166),i=s(9143),n=s(5196),u=s(8266),l=s(1863),c={components:{Pagination:i.Z,Modal:n.Z,DeleteModal:u.Z,Table:l.Z},data(){return{products:[],tempProduct:{},isNew:!1,isLoading:!1,status:{update:!1,upload_img:!1},pagination:{}}},methods:{getProducts(t=1){const e=`https://vue-course-api.hexschool.io/api/gunshop/products?page=${t}`,s=this;s.isLoading=!0,s.$http.get(e).then((t=>{s.isLoading=!1,s.products=t.data.products,s.pagination=t.data.pagination}))},openModal(t,e){const s=this;t?(s.tempProduct={},s.isNew=!0):(s.tempProduct=Object.assign({},e),s.isNew=!1);const a=new d.u_("#modalComponent");a.show()},delModal(t){this.tempProduct=Object.assign({},t);const e=new d.u_("#delModal");e.show()},updateProduct(){let t="https://vue-course-api.hexschool.io/api/gunshop/admin/product",e="post";const s=this;s.isNew||(t=`https://vue-course-api.hexschool.io/api/gunshop/admin/product/${s.tempProduct.id}`,e="put"),s.status.update=!0,s.$http[e](t,{data:s.tempProduct}).then((t=>{console.log(t.data),t.data.success?s.$bus.$emit("msg-pop",t.data.message,"success"):s.$bus.$emit("msg-pop",t.data.message,"danger"),s.status.update=!1,s.getProducts(),s.hideModal()}))},hideModal(){const t=document.querySelector("#modalComponent"),e=d.u_.getInstance(t);e.hide()},hideDelModal(){const t=document.querySelector("#delModal"),e=d.u_.getInstance(t);e.hide()},delProduct(){const t=this;t.status.update=!0;const e=`https://vue-course-api.hexschool.io/api/gunshop/admin/product/${t.tempProduct.id}`;t.$http.delete(e).then((e=>{t.status.update=!1,t.$bus.$emit("msg-pop",e.data.message,"success"),t.hideDelModal(),t.getProducts()}))}},created(){this.getProducts()}},r=c,p=s(1001),m=(0,p.Z)(r,a,o,!1,null,null,null),h=m.exports}}]);
//# sourceMappingURL=471.b87afad1.js.map